# Simple NFS Daemon Configuration
# Advanced configuration for high-performance and security

[server]
# Network configuration
bind_address = 0.0.0.0
port = 2049

# Protocol support
enable_tcp = true
enable_udp = true
enable_nfsv2 = false
enable_nfsv3 = true
enable_nfsv4 = true

# Performance settings
max_connections = 5000
read_buffer_size = 131072
write_buffer_size = 131072
thread_count = 32
worker_threads = 16

# File system settings
root_path = /var/lib/simple-nfsd/shares
max_file_size = 1099511627776  # 1TB
cache_size = 1073741824  # 1GB

[logging]
# Advanced logging configuration
log_level = DEBUG
log_file = /var/log/simple-nfsd/simple-nfsd.log
log_max_size = 104857600  # 100MB
log_max_files = 20
log_rotation = hourly
log_format = json
log_include_timestamp = true
log_include_thread_id = true

[security]
# Advanced security settings
security_mode = sys
root_squash = true
all_squash = false
anon_uid = 65534
anon_gid = 65534

# Authentication
auth_sys_enabled = true
auth_dh_enabled = true
kerberos_enabled = true
ldap_enabled = true

# Access control
allowed_networks = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12
denied_networks = 192.168.1.100,10.0.0.100
require_authentication = true

# Encryption
tls_enabled = true
tls_cert_file = /etc/ssl/certs/simple-nfsd.crt
tls_key_file = /etc/ssl/private/simple-nfsd.key
tls_ca_file = /etc/ssl/certs/ca.crt

[exports]
# Advanced export configuration
/data/shared,192.168.0.0/16,rw,sync,no_root_squash,no_subtree_check,fsid=1
/data/backup,192.168.1.0/24,ro,sync,root_squash,subtree_check,fsid=2
/home/users,192.168.0.0/16,rw,sync,no_root_squash,subtree_check,fsid=3
/tmp/public,*,ro,sync,all_squash,fsid=4

[monitoring]
# Advanced monitoring
health_check_interval = 10
metrics_enabled = true
metrics_port = 9090
performance_monitoring = true
detailed_statistics = true
real_time_monitoring = true

# Alerting
alert_on_high_cpu = true
alert_on_high_memory = true
alert_on_connection_limit = true
alert_threshold_cpu = 80
alert_threshold_memory = 85
alert_threshold_connections = 90

[backup]
# Advanced backup configuration
backup_enabled = true
backup_schedule = "0 2 * * *"  # Daily at 2 AM
backup_retention_days = 90
backup_compression = true
backup_encryption = true
backup_remote_location = s3://backup-bucket/simple-nfsd/

[clustering]
# Clustering configuration
cluster_enabled = true
cluster_nodes = nfs1.example.com,nfs2.example.com,nfs3.example.com
cluster_heartbeat_interval = 5
cluster_failover_timeout = 30
cluster_quorum_required = true

[performance]
# Performance tuning
tcp_nodelay = true
tcp_keepalive = true
tcp_keepalive_time = 600
tcp_keepalive_interval = 60
tcp_keepalive_probes = 3

# Memory management
memory_pool_size = 2147483648  # 2GB
memory_pool_cleanup_interval = 300
memory_pool_max_age = 3600

# I/O optimization
async_io_enabled = true
direct_io_enabled = true
read_ahead_size = 1048576  # 1MB
write_behind_size = 1048576  # 1MB
